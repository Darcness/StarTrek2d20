import { makeKey } from "../../common/translationKey";
import EarCatalog from "./earCatalog";
import { ExtraCategory, ExtraType } from "./extrasTypeEnum";
import { Eye2StandardBrows } from "./eyeBrowCatalog";
import { Eye2 } from "./eyeCatalog";
import SpeciesRestrictions from "./speciesRestrictions";
import Swatch from "./swatch";
import { Token } from "./token";

const BajoranEarring = `<g>
    <path id="path99636" style="fill:#959595;stroke:#000000;stroke-width:0.5;stroke-linecap:butt;stroke-linejoin:miter;stroke-dasharray:none;stroke-opacity:1;fill-opacity:1" d="m 213.02839,175.37813 c -0.0349,-0.01 -0.07,-0.0141 -0.10412,-0.0109 -0.36334,0.031 -0.3886,0.45463 -0.3757,0.77819 0.0129,0.32355 0.22219,0.89334 0.54524,0.93066 0.32304,0.0373 0.57674,-0.26741 0.60222,-0.63257 0.0232,-0.33092 -0.33067,-0.97133 -0.66764,-1.06537 z m -1.77966,4.36441 c -0.0349,-0.01 -0.07,-0.0141 -0.10412,-0.0109 -0.36334,0.031 -0.3886,0.45463 -0.3757,0.77819 0.0129,0.32355 0.22219,0.89334 0.54524,0.93066 0.32304,0.0373 0.57674,-0.26741 0.60222,-0.63257 0.0232,-0.33092 -0.33067,-0.97133 -0.66764,-1.06537 z m -6.48305,3.51695 c -0.0349,-0.01 -0.07,-0.0141 -0.10412,-0.0109 -0.36334,0.031 -0.3886,0.45463 -0.3757,0.77819 0.0129,0.32355 0.22219,0.89334 0.54524,0.93066 0.32304,0.0373 0.57674,-0.26741 0.60222,-0.63257 0.0232,-0.33092 -0.33067,-0.97133 -0.66764,-1.06537 z m 3.81356,-0.0847 c -0.0349,-0.01 -0.07,-0.0141 -0.10412,-0.0109 -0.36334,0.031 -0.3886,0.45463 -0.3757,0.77819 0.0129,0.32355 0.22219,0.89334 0.54524,0.93066 0.32304,0.0373 0.57674,-0.26741 0.60222,-0.63257 0.0232,-0.33092 -0.33067,-0.97133 -0.66764,-1.06537 z m -6.68168,-3.6731 c -0.0381,-0.009 -0.0752,-0.009 -0.10947,6.9e-4 -0.36597,0.10444 -0.29353,0.73495 -0.20514,1.21131 0.0884,0.47637 0.43567,1.28515 0.77612,1.28823 0.34045,0.003 0.53026,-0.48845 0.47163,-1.03253 -0.053,-0.49306 -0.56518,-1.38297 -0.93312,-1.46767 z m -2.00846,-5.62355 c -0.0362,-0.0149 -0.0728,-0.021 -0.10825,-0.0163 -0.37775,0.0464 -0.404,0.68051 -0.39059,1.16482 0.0134,0.48431 0.23101,1.33718 0.56686,1.39304 0.33586,0.0558 0.59962,-0.40027 0.62611,-0.94686 0.0241,-0.49532 -0.34377,-1.45391 -0.69412,-1.59467 z m -1.60647,-5.49149 c -0.0349,-0.01 -0.07,-0.0141 -0.10412,-0.0109 -0.36334,0.031 -0.3886,0.45463 -0.3757,0.77819 0.0129,0.32355 0.22219,0.89334 0.54524,0.93066 0.32304,0.0373 0.57674,-0.26741 0.60222,-0.63257 0.0232,-0.33092 -0.33067,-0.97133 -0.66764,-1.06537 z m -0.92851,-4.42308 c -0.036,0.005 -0.0697,0.0156 -0.0995,0.0324 -0.31935,0.17605 -0.17018,0.57335 -0.0268,0.86372 0.14334,0.29035 0.56623,0.72581 0.87654,0.62856 0.3103,-0.0973 0.41818,-0.47881 0.29299,-0.82279 -0.11336,-0.31176 -0.69705,-0.75296 -1.04314,-0.70186 z m -0.37324,-4.88993 c -0.0384,-0.0129 -0.0771,-0.0182 -0.11454,-0.0141 -0.39991,0.04 -0.42772,0.58666 -0.41352,1.00418 0.0141,0.41751 0.24455,1.15277 0.60013,1.20093 0.35555,0.0482 0.63479,-0.34507 0.66284,-0.81627 0.0255,-0.42703 -0.36396,-1.25341 -0.73486,-1.37476 z m -0.81689,-4.71241 c -0.0349,-0.01 -0.07,-0.0141 -0.10412,-0.0109 -0.36334,0.031 -0.3886,0.45463 -0.3757,0.77819 0.0129,0.32355 0.22219,0.89334 0.54524,0.93066 0.32304,0.0373 0.57674,-0.26741 0.60222,-0.63257 0.0232,-0.33092 -0.33067,-0.97133 -0.66764,-1.06537 z m -0.63559,-4.15254 c -0.0349,-0.01 -0.07,-0.0141 -0.10412,-0.0109 -0.36334,0.031 -0.3886,0.45463 -0.3757,0.77819 0.0129,0.32355 0.22219,0.89334 0.54524,0.93066 0.32304,0.0373 0.57674,-0.26741 0.60222,-0.63257 0.0232,-0.33092 -0.33067,-0.97133 -0.66764,-1.06537 z m -0.89161,-4.23343 c -0.0362,-6.5e-4 -0.0713,0.004 -0.10352,0.0156 -0.34387,0.12138 -0.26181,0.53774 -0.16797,0.84766 0.0938,0.30992 0.43967,0.80877 0.76172,0.76367 0.32205,-0.0451 0.49098,-0.40383 0.42383,-0.76367 -0.0608,-0.32611 -0.56427,-0.85698 -0.91406,-0.86328 z m -0.65374,-3.94136 c -0.34387,0.12138 -0.26333,0.53754 -0.16949,0.84746 0.0938,0.30992 0.44066,0.80781 0.76271,0.76271 0.32205,-0.0451 0.49088,-0.40287 0.42373,-0.76271 -0.0671,-0.35984 -0.67308,-0.96884 -1.01695,-0.84746 z m 22.9661,27.28813 c 0,0 0.89173,2.12559 0.50848,3.05085 -0.38325,0.92526 -2.37288,1.69492 -2.37288,1.69492 0,0 0.46735,2.12857 0,3.05084 -0.46735,0.92227 -2.36261,1.62471 -2.36261,1.62471 0,0 0.56545,2.48291 0.15922,3.29055 -0.40623,0.80764 -2.0339,1.18644 -2.0339,1.18644 0,0 0.003,3.02143 -1.01695,3.55932 -1.01977,0.53789 -3.05085,-1.01695 -3.05085,-1.01695 0,0 -1.96315,1.19994 -2.88135,0.67797 -0.9182,-0.52197 -0.8971,-2.86079 -0.8971,-2.86079 0,0 -1.91377,-0.49847 -2.49274,-1.3765 -0.57897,-0.87803 0,-3.72881 0,-3.72881 0,0 -2.1514,-1.49854 -2.54237,-2.71187 -0.39097,-1.21333 0.62833,-3.29906 0.62833,-3.29906 0,0 -1.5736,-1.0003 -1.98426,-1.95518 -0.41066,-0.95488 0.50847,-3.8983 0.50847,-3.8983 0,0 -1.21723,-1.08107 -1.35593,-1.86441 -0.1387,-0.78334 0.73789,-1.83356 0.73789,-1.83356 0,0 -0.97464,-0.85591 -1.24636,-1.72576 -0.27172,-0.86985 0.67796,-3.72881 0.67796,-3.72881 0,0 -1.16368,-0.74265 -1.35593,-1.52543 -0.19225,-0.78278 0.67797,-2.71186 0.67797,-2.71186 0,0 -1.17945,-0.88631 -1.35593,-1.69492 -0.17648,-0.80861 0.67796,-2.71186 0.67796,-2.71186 0,0 -1.2037,-0.93699 -1.35593,-1.69492 -0.15223,-0.75793 0.67797,-2.37288 0.67797,-2.37288 0,0 -1.27424,-1.01651 -1.35594,-1.8644 -0.0817,-0.84789 1.18644,-2.54238 1.18644,-2.54238 l 0.36601,0.12359 c 0,0 1.80608,1.36966 1.91758,2.2172 0.1115,0.84754 -0.95879,1.9775 -0.95879,1.9775 0,0 1.34967,1.01101 1.49811,1.79773 0.14844,0.78672 -0.77902,2.33705 -0.77902,2.33705 0,0 1.54466,1.04874 1.67788,1.85765 0.13322,0.80891 -0.95879,2.2172 -0.95879,2.2172 0,0 1.44545,0.97026 1.61796,1.79773 0.17251,0.82747 -0.83894,2.51682 -0.83894,2.51682 0,0 1.68134,1.30485 1.85765,2.33705 0.17631,1.0322 -1.07864,3.11606 -1.07864,3.11606 0,0 1.58834,1.09256 1.67788,1.85765 0.0895,0.76509 -1.01871,1.85766 -1.01871,1.85766 0,0 1.57949,1.40014 1.79773,2.39697 0.21824,0.99683 -0.65917,3.05614 -0.65917,3.05614 0,0 1.65483,1.45158 1.9775,2.45689 0.32267,1.00531 -0.17977,3.17599 -0.17977,3.17599 0,0 1.66839,1.17317 2.03743,2.03743 0.36904,0.86426 0.0599,2.75652 0.0599,2.75652 0,0 1.27243,-0.63344 1.85766,-0.35955 0.58523,0.27389 0.95878,1.73781 0.95878,1.73781 0,0 0.34395,-2.00815 1.07864,-2.33705 0.73469,-0.3289 2.15728,0.65917 2.15728,0.65917 0,0 -0.50318,-2.0438 -0.11985,-2.75652 0.38333,-0.71272 1.79773,-1.07864 1.79773,-1.07864 0,0 -0.39724,-2.91887 0.17977,-3.71531 0.57701,-0.79644 2.03743,-0.77901 2.03743,-0.77901 0,0 -1.12345,-2.06837 -0.77902,-2.99622 0.34443,-0.92785 2.33705,-1.61795 2.33705,-1.61795 z"/>
    <path style="fill:#959595;stroke:#000000;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;fill-opacity:1" d="m 190.50847,141.18644 9.15255,-2.0339 v -6.27118 l -9.15254,-3.72882 c 0,0 -1.69913,1.42383 -1.69492,5.76272 0.004,4.33889 1.69491,6.27118 1.69491,6.27118 z" id="path93966"/>
    <g id="g94800">
        <path id="path94066" style="fill:#959595;stroke:#000000;stroke-width:0.5;stroke-miterlimit:40;stroke-dasharray:none;fill-opacity:1" d="m 211.00061,152.89104 3.84411,23.20326 a 11.767667,11.767667 0 0 0 9.52221,-13.49365 11.767667,11.767667 0 0 0 -13.36632,-9.70961 z"/>
        <path id="circle94031" style="fill:none;stroke:#000000;stroke-width:0.5;stroke-miterlimit:40;stroke-dasharray:none" d="m 211.8622,158.09164 2.12029,12.79821 a 6.4971318,6.4971318 0 0 0 5.18384,-7.42761 6.4971318,6.4971318 0 0 0 -7.30413,-5.3706 z"/>
        <path id="circle94033" style="fill:none;stroke:#000000;stroke-width:0.5;stroke-miterlimit:40;stroke-dasharray:none" d="m 211.5749,156.35747 2.69521,16.26848 a 8.2539768,8.2539768 0 0 0 6.6304,-9.45101 8.2539768,8.2539768 0 0 0 -9.32561,-6.81747 z"/>
        <path id="circle94035" style="fill:none;stroke:#000000;stroke-width:0.5;stroke-miterlimit:40;stroke-dasharray:none" d="m 211.28759,154.62329 3.26951,19.73491 a 10.010821,10.010821 0 0 0 8.07565,-11.47024 10.010821,10.010821 0 0 0 -11.34516,-8.26467 z"/>
        <path id="circle94037" style="fill:none;stroke:#000000;stroke-width:0.5;stroke-miterlimit:40;stroke-dasharray:none" d="m 211.00061,152.89104 3.84411,23.20326 a 11.767667,11.767667 0 0 0 9.52221,-13.49365 11.767667,11.767667 0 0 0 -13.36632,-9.70961 z"/>
        <circle style="fill:#959595;stroke:#000000;stroke-width:1;stroke-miterlimit:40;stroke-dasharray:none;fill-opacity:1" id="path94020" cx="183.00563" cy="197.08517" r="4.9000001" transform="rotate(-9.4068188)"/>
    </g>
    <ellipse style="fill:#ffffff;fill-opacity:0.3;stroke:none;stroke-width:1.38872;stroke-miterlimit:40;stroke-dasharray:none" id="path95580" cx="37.803864" cy="-265.95657" rx="1.1180413" ry="1.8241726" transform="rotate(119.37683)"/>
    <path style="fill:#ffffff;fill-opacity:0.3;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" d="m 193.38983,140.33898 c 0,0 -0.99465,-2.47346 -1.1017,-4.66101 -0.10704,-2.18754 1.27119,-5.1695 1.27119,-5.1695 l -1.69491,-0.84745 c 0,0 -1.30661,3.46833 -1.27119,5.9322 0.0354,2.46387 1.27119,5 1.27119,5 z" id="path96568"/>
    <path style="fill:none;stroke:#000000;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;fill-opacity:1" d="m 190.50847,141.18644 9.15255,-2.0339 v -6.27118 l -9.15254,-3.72882 c 0,0 -1.69913,1.42383 -1.69492,5.76272 0.004,4.33889 1.69491,6.27118 1.69491,6.27118 z" id="path96570"/>
</g>`

const SimpleEarring = `<g>
    <circle style="fill:#959595;stroke:#000000;stroke-width:0.5;stroke-miterlimit:40" id="path102376" cx="213.81355" cy="160.08475" r="1.7796611"/>
    <path id="circle102378" style="fill:#ffffff;stroke:none;stroke-width:0.5;stroke-miterlimit:40;fill-opacity:0.2" d="M 213.81445 158.30469 A 1.7796611 1.7796611 0 0 0 212.0332 160.08398 A 1.7796611 1.7796611 0 0 0 212.14453 160.6875 A 1.7796611 1.7796611 0 0 1 213.89844 159.19531 A 1.7796611 1.7796611 0 0 1 215.56836 160.36133 A 1.7796611 1.7796611 0 0 0 215.59375 160.08398 A 1.7796611 1.7796611 0 0 0 213.81445 158.30469 z "/>
    <circle style="fill:none;stroke:#000000;stroke-width:0.5;stroke-miterlimit:40" id="circle102383" cx="213.81355" cy="160.08475" r="1.7796611"/>
</g>`;

const HoopEarring = `<g>
    <path id="ellipse939" style="fill:#878787;fill-opacity:1;stroke:#000000;stroke-width:0.660782;stroke-miterlimit:40" d="m 213.54539,160.62286 c 3.88503,0.17977 6.33276,5.56324 6.33276,13.15763 0,7.59439 -2.4229,13.07288 -6.24801,13.07288 -3.82511,0 -6.84123,-5.47849 -6.84123,-13.07288 0,-2.86312 0.7549,-5.1632 1.50901,-7.36473 -0.28844,-0.53337 -1.11486,-0.82329 -1.59156,-0.69176 -0.90568,2.34523 -1.61536,5.10406 -1.61536,8.05649 0,8.52532 4.05713,15.43646 8.53914,15.43646 4.48202,1e-5 8.11542,-6.91113 8.11542,-15.43646 0,-8.52533 -3.6334,-15.43646 -8.11542,-15.43646 -0.37652,0.53191 -0.34254,1.65704 -0.0848,2.27883 z"/>
    <path style="color:#000000;fill:#ffffff;-inkscape-stroke:none;fill-opacity:0.30000001" d="m 218.84375,163.41309 c 0,0 1.67685,4.19303 1.80664,9.74707 0.12925,5.53131 -1.86719,11.19628 -1.86719,11.19628 0,0 2.70241,-5.47737 2.56836,-11.21386 -0.13352,-5.71375 -2.50781,-9.72949 -2.50781,-9.72949 z" id="path2653"/>
</g>`;

const SmallBindi = `<ellipse style="fill:#821c2b;fill-opacity:1;stroke:#000000;stroke-width:0.500001;stroke-miterlimit:40;stroke-dasharray:none;stroke-opacity:1" id="path6783" cx="315.79523" cy="121.07501" rx="2.7118647" ry="3.2203395"/>`;

const RisanSymbol = `<g>
    <ellipse style="fill:#dcd18e;fill-opacity:1;stroke:#000000;stroke-width:0.715546;stroke-miterlimit:40;stroke-dasharray:none;stroke-opacity:1" id="ellipse8365" cx="315.79523" cy="113.95172" rx="7.1894622" ry="6.9182663"/>
    <path style="color:#000000;fill:#000000;stroke-width:1.43109;stroke-miterlimit:40;-inkscape-stroke:none" d="m 312.8373,115.7618 -0.0504,-0.0419 0.0252,0.0252 z" id="path8891"/>
    <path style="color:#000000;fill:#845a17;fill-opacity:1;stroke-width:1.35581;stroke-miterlimit:40;-inkscape-stroke:none" d="m 312.15686,110.03725 c -0.29922,0.21666 -0.60727,0.58817 -0.85797,1.06981 -0.2507,0.48165 -0.43693,1.07322 -0.43693,1.71594 0,1.23957 0.5271,2.65613 1.75035,3.4213 0.9793,0.61225 2.20669,0.57462 3.24389,0.57462 1.13873,0 2.33468,0.17889 3.35774,-0.5958 1.03486,-0.78367 1.63385,-2.21465 1.63385,-3.40012 0,-1.23224 -0.69991,-2.31216 -1.72388,-3.02143 -0.13696,-0.10791 -0.32175,-0.15999 -0.56668,-0.16153 -0.22272,-0.001 -0.3972,0.10819 -0.54552,0.2595 -0.14829,0.15139 -0.2671,0.36843 -0.26744,0.62494 6.5e-4,0.47993 0.37995,0.88716 0.85796,0.88711 0.10075,-6e-5 0.1774,-0.0764 0.27011,-0.1112 0.42615,0.45122 0.70703,0.96205 0.70703,1.52262 0,0.33007 -0.13109,0.83396 -0.34425,1.2949 -0.21309,0.46095 -0.51283,0.88378 -0.78647,1.09101 -0.26958,0.20413 -0.59493,0.29294 -1.02481,0.32836 -0.42987,0.0354 -0.95326,0.0129 -1.56764,0.0129 -1.03085,0 -2.069,-0.0683 -2.56862,-0.38133 l -0.006,-0.003 c -0.73946,-0.46256 -1.14925,-1.47773 -1.14925,-2.34354 0,-0.5846 0.3022,-1.11717 0.76529,-1.58089 0.093,0.0351 0.17162,0.10848 0.27275,0.10862 0.47801,6e-5 0.85732,-0.40716 0.85797,-0.8871 -3.3e-4,-0.23998 -0.0912,-0.45135 -0.22244,-0.60906 -0.13137,-0.15771 -0.30561,-0.2768 -0.55132,-0.28161 -0.24572,-0.006 -0.57925,0.0882 -1.0983,0.46402 z" id="path8877"/>
    <path id="path8546" style="color:#000000;fill:#845a17;fill-opacity:1;stroke-width:1.80043;-inkscape-stroke:none" d="m 312.69064,117.02906 a 0.8719825,0.91558157 0 0 0 -0.87208,0.9143 0.8719825,0.91558157 0 0 0 0.87208,0.91779 0.8719825,0.91558157 0 0 0 0.87209,-0.91779 0.8719825,0.91558157 0 0 0 0,-0.0143 h 4.62062 a 0.8719825,0.91558157 0 0 0 0,0.0143 0.8719825,0.91558157 0 0 0 0.8721,0.91779 0.8719825,0.91558157 0 0 0 0.87207,-0.91779 0.8719825,0.91558157 0 0 0 -0.61187,-0.87209 v -0.0422 h -0.21803 -0.0422 -6.32262 a 0.8719825,0.91558157 0 0 0 -0.0422,0 z"/>
</g>`;

class ExtraItem {

    readonly id: ExtraType;
    readonly category: ExtraCategory;
    readonly name: string;
    readonly svg: string;

    constructor(id: ExtraType, category: ExtraCategory, name: string, svg: string) {
        this.id = id;
        this.category = category;
        this.name = name;
        this.svg = svg;
    }
}


class ExtrasCatalog {

    private static _instance: ExtrasCatalog;

    private items = [
        new ExtraItem(ExtraType.None, ExtraCategory.Ear, "None", ""),
        new ExtraItem(ExtraType.BajoranEarring, ExtraCategory.Ear, "Bajoran Earring", BajoranEarring),
        new ExtraItem(ExtraType.SimpleEarring, ExtraCategory.Ear, "Simple Stud Earring", SimpleEarring),
        new ExtraItem(ExtraType.HoopEarring, ExtraCategory.Ear, "Hoop Earring", HoopEarring),

        new ExtraItem(ExtraType.None, ExtraCategory.Forehead, "None", ""),
        new ExtraItem(ExtraType.SmallBindi, ExtraCategory.Forehead, "Small Bindi", SmallBindi),
        new ExtraItem(ExtraType.RisanSymbol, ExtraCategory.Forehead, "Risan Symbol", RisanSymbol)
    ]

    public static get instance() {
        if (ExtrasCatalog._instance == null) {
            ExtrasCatalog._instance = new ExtrasCatalog();
        }
        return ExtrasCatalog._instance;
    }

    getExtras(token: Token, category: ExtraCategory) {
        return this.items.filter(i => i.category === category && token.extras.indexOf(i.id) >= 0).map(i => i.svg).join();
    }

    getSwatches(token: Token, category: ExtraCategory) {
        return this.items
            .filter(i => (category === i.category) && (SpeciesRestrictions.isExtraAvailableFor(i.id, token.species)))
            .map(i => new Swatch(i.id, i.name, (token) => ExtrasCatalog.decorateSwatch(i, token), makeKey("ExtraType.", ExtraType[i.id])));
    }

    isInCategory(type: ExtraType, category: ExtraCategory) {
        return this.items.filter(i => i.id === type && i.category === category).length > 0;
    }

    static decorateSwatch(item: ExtraItem, token: Token) {
        if (item.category === ExtraCategory.Ear) {
            return `<svg viewBox="0 0 80 80" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                    <defs>
                        <clipPath id="extraClipPath-` + item.category + "-" +  + item.id + `">
                            <circle cx="40" cy="40" r="40" fill="#ffffff" />
                        </clipPath>
                    </defs>
                    <g clip-path="url(#extraClipPath-` + item.id + `">
                    <g transform="translate(-165, -115)">`
                    + EarCatalog.instance.getEar(token)
                    + item.svg
                    + `</g>
                    </g>
                </svg>`;
        } else {
            return `<svg viewBox="0 0 110 110" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                    <defs>
                        <clipPath id="extraClipPath-` + item.category + "-" + item.id + `">
                            <circle cx="55" cy="55" r="55" fill="#ffffff" />
                        </clipPath>
                    </defs>
                    <g clip-path="url(#extraClipPath-` + item.id + `">
                        <g transform="translate(-250, -70)">`
                        + Eye2StandardBrows.replace(SpeciesRestrictions.DEFAULT_HAIR_COLOR_REGEX, token.hairColor)
                        + Eye2.replace(SpeciesRestrictions.DEFAULT_EYE_COLOR_REGEX, token.eyeColor)
                        + item.svg
                    + `</g>
                    </g>
                </svg>`;
        }
    }
}

export default ExtrasCatalog;